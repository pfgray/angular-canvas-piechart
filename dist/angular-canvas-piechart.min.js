/* 
 angular-canvas-piechart v1.0.0
 Compiled on: 16-11-2014
 License: MIT
*/
angular.module("ngPiechart",[]).directive("pieChart",function(){return{restrict:"A",transclude:!1,scope:!1,link:function(a,b,c){var d=a.$eval(c.model),e=a.$eval(c.pieChart),f=b[0],g=f.getContext("2d"),h=f.offsetWidth,i=f.offsetHeight,j=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].value;for(var c=0;c<a.length;c++)a[c].$pieChartPercentage=a[c].value/b*100;return a},k=0,l=e.duration||500,m=isNaN(e.lineWidth)?3:e.lineWidth,n=e.lineColor||"black",o={x:h/2,y:i/2},p=Math.min(i,h)/2-m,q=0,r=function(){d=j(a.$eval(c.model));var b=function(a){return k+=a/l,k>=1?(k=1,!0):void 0},e=function(a){a.clearRect(0,0,h,i);for(var b=q,c=0;c<d.length;c++){a.save(),a.strokeStyle=n,a.lineWidth=m,a.moveTo(o.x,o.y),a.beginPath();var e=b,f=b+=2*k*Math.PI*(d[c].$pieChartPercentage/100);a.fillStyle=d[c].color,a.arc(o.x,o.y,p,e,f,!1),m>0&&a.stroke(),a.lineTo(o.x,o.y),a.fill(),a.restore()}},f=new Date,r=!1,s=setInterval(function(){var a=new Date;b(a-f)&&(clearInterval(s),e(g),r=!0),r||e(g),f=a},0)};d&&d.length>0&&r(),a.$watch(c.model,function(a,b){a&&b!==a&&a.length&&r()})}}});